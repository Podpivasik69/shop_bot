<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}SKET Shop{% endblock %}</title>

    {% load static %}
    <!-- ĞÑĞ½Ğ¾Ğ²Ğ½Ñ‹Ğµ ÑÑ‚Ğ¸Ğ»Ğ¸ -->
    <link rel="stylesheet" href="{% static 'products/css/catalog.css' %}?v=3.0">
    <!-- Ğ¡Ñ‚Ğ¸Ğ»Ğ¸ Ñ„ÑƒÑ‚ĞµÑ€Ğ° (Ğ´Ğ¾Ğ±Ğ°Ğ²Ğ¸Ğ¼ Ğ¿Ğ¾Ğ·Ğ¶Ğµ) -->
    <link rel="stylesheet" href="{% static 'css/footer.css' %}">
    <!-- Ğ“Ğ»Ğ¾Ğ±Ğ°Ğ»ÑŒĞ½Ñ‹Ğµ ÑÑ‚Ğ¸Ğ»Ğ¸ -->
    <link rel="stylesheet" href="{% static 'css/global.css' %}">

    {% block extra_css %}{% endblock %}
</head>
<body>
<!-- ĞÑĞ½Ğ¾Ğ²Ğ½Ğ¾Ğ¹ ĞºĞ¾Ğ½Ñ‚ĞµĞ½Ñ‚ -->
<main class="main-content">
    {% block content %}
    <!-- Ğ¡ÑĞ´Ğ° Ğ±ÑƒĞ´ĞµÑ‚ Ğ¿Ğ¾Ğ´ÑÑ‚Ğ°Ğ²Ğ»ÑÑ‚ÑŒÑÑ ĞºĞ¾Ğ½Ñ‚ĞµĞ½Ñ‚ ÑÑ‚Ñ€Ğ°Ğ½Ğ¸Ñ† -->
    {% endblock %}
</main>

<!-- Ğ¤Ğ˜ĞšĞ¡Ğ˜Ğ ĞĞ’ĞĞĞĞ«Ğ™ Ğ¤Ğ£Ğ¢Ğ•Ğ  -->
<footer class="main-footer">
    <div class="footer-grid">
        <!-- ĞšĞ°Ñ‚Ğ°Ğ»Ğ¾Ğ³ -->
        <a href="{% url 'products:catalog' %}"
           class="footer-item {% if request.path == '/' %}active{% endif %}"
           id="footer-catalog">
            <div class="footer-icon">ğŸª</div>
            <div class="footer-label">ĞšĞ°Ñ‚Ğ°Ğ»Ğ¾Ğ³</div>
        </a>

        <!-- ĞšĞ¾Ñ€Ğ·Ğ¸Ğ½Ğ° -->
        <a href="{% url 'cart:cart' %}"
           class="footer-item {% if '/cart/' in request.path %}active{% endif %}"
           id="footer-cart">
            <div class="footer-icon">ğŸ›’</div>
            <div class="footer-label">ĞšĞ¾Ñ€Ğ·Ğ¸Ğ½Ğ°</div>
        </a>

        <!-- Ğ—Ğ°ĞºĞ°Ğ·Ñ‹ -->
        <a href="{% url 'orders:my_orders' %}"
           class="footer-item {% if '/orders/' in request.path %}active{% endif %}"
           id="footer-orders">
            <div class="footer-icon">ğŸ“¦</div>
            <div class="footer-label">Ğ—Ğ°ĞºĞ°Ğ·Ñ‹</div>
        </a>

        <!-- ĞŸÑ€Ğ¾Ñ„Ğ¸Ğ»ÑŒ -->
        <a href="{% url 'user_profile:profile' %}"
           class="footer-item {% if '/profile/' in request.path %}active{% endif %}"
           id="footer-profile">
            <div class="footer-icon">ğŸ‘¤</div>
            <div class="footer-label">ĞŸÑ€Ğ¾Ñ„Ğ¸Ğ»ÑŒ</div>
        </a>
    </div>
</footer>

{% block extra_js %}{% endblock %}
</body>
<!-- Telegram WebApp SDK + Ğ¿Ñ€Ğ¾ÑÑ‚Ğ¾Ğ¹ ĞºĞ¾Ğ´ -->
<script src="https://telegram.org/js/telegram-web-app.js"></script>
<script>
    document.addEventListener('DOMContentLoaded', function () {
        // ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑĞµĞ¼ Ñ‡Ñ‚Ğ¾ Ğ² Telegram WebApp
        if (window.Telegram && Telegram.WebApp) {
            const user = Telegram.WebApp.initDataUnsafe.user;
            if (user && user.id) {
                // ĞŸÑ€Ğ¾ÑÑ‚Ğ¾ Ğ¾Ñ‚Ğ¿Ñ€Ğ°Ğ²Ğ»ÑĞµĞ¼, Ğ½Ğµ Ğ¶Ğ´ĞµĞ¼ Ğ¾Ñ‚Ğ²ĞµÑ‚Ğ°
                fetch('/api/telegram-user/', {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({
                        telegram_id: String(user.id),  // ĞĞ±ÑĞ·Ğ°Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ ÑÑ‚Ñ€Ğ¾ĞºĞ°!
                        username: user.username || '',
                        first_name: user.first_name || '',
                        last_name: user.last_name || '',
                        photo_url: user.photo_url || ''
                    })
                }).catch(error => console.log('Telegram sync error:', error));
            }
        }
    });
</script>
</html>